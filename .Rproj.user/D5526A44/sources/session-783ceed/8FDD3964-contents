---
title: "data_exploration_part1"
output: html_notebook
---


# Business Question 1: Does the weather effectively influence the flights departure delays?

```{r}
library(tidyverse)
library(GGally)
```


```{r}
flights_weather <- read_csv(here::here("cleaned_data/flights_weather.csv"))
flights_weather
```


```{r}
flights_weather %>% 
  summarise(across(.col = everything(), .fns = ~sum(is.na(.x))))
```

```{r}
tight_flights_weather <- read_csv(here::here(""))
```




```{r}
flights_weather %>% 
  filter(!is.na(arr_delay)) %>% 
  summarise(cor(dep_delay, arr_delay))
```

**ASSUMPTION 2**
First of all we notice that the arrival delays are strongly positive correlated with the departure delay. Since also the weather dataset refers only to the departure airports and for now I decided to ignore the arrival delays, I could consider to leave the `flights_weather` dataset as it is and to consider a smoller dataset to possibly join with the other that doesn't contains the departure delays.



```{r}
flights_weather %>% 
  select(dep_delay, wind_dir, wind_speed, wind_gust, visib) %>% 
  ggcorr(label = TRUE)
```


At a first sight, looking at the correlation indexes, it seems that there is not so much interaction between `dep_delays` and `weather` conditions.



```{r}
flights_weather %>% 
  select(dep_delay, wind_dir, wind_speed, wind_gust, visib) %>% 
  ggpairs(progress = FALSE)
```



First of all, we notice that there is a very strong correlation between `wind speed` and `wind gust speed` for this reason we could consider to delete one of the two since their relationship is so strong.


# Wind Speed

```{r}
flights_weather %>% 
  distinct(wind_speed) %>% 
  arrange(desc(wind_speed))
```
 
 
In the following, I will start categorising the wind speed in different categories for 



```{r}
prova <- flights_weather %>% 
  mutate(wind_speed_cat = case_when(
    wind_speed >= 0 & wind_speed <= 5 ~ "0 - 5",
    wind_speed > 5 & wind_speed <= 15 ~ "6 - 15",
    wind_speed > 15 & wind_speed <= 25 ~ "16 - 25",
    wind_speed > 25 & wind_speed <= 35 ~ "26 - 35"
  ))
```







```{r}
prova %>%
  group_by(month, wind_speed_cat) %>% 
  summarise(mean_dep_delay = mean(dep_delay, na.rm = TRUE)) %>% 
  ggplot()+
  aes(x = month, y = mean_dep_delay, fill = wind_speed_cat)+
  geom_col(position = "dodge")+
  #geom_line() +
  geom_vline(xintercept = 0) +
  geom_hline(yintercept = 0) + 
  theme_light()+
  labs(
    x = "\n months",
    y = "departure delays mean (in mins)\n",
    title = "\nDeparture delays depending on different wind speed conditions\n"
  )+
  scale_x_continuous(n.breaks = 12)
```





























```{r}
flights_weather %>% 
  ggplot()+
  aes(x = time_hour, y = dep_delay)+
  geom_point()
```

```{r}
flights_weather %>% 
  distinct(dep_delay) %>% 
  arrange(desc(dep_delay))
```




```{r}
flights_weather %>% 
  filter(month == "10" & day == "12") %>% 
  ggplot()+
  aes(x = time_hour, y = dep_delay)+
  geom_point()
  
```






```{r}
flights_weather %>% 
  filter(month == "10" & day == "12") %>% 
  ggplot()+
  aes(x = wind_speed, y = dep_delay)+
  geom_point()
```




















































































































